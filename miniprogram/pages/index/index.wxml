<!--pages/index/index.wxml-->
<view class="container">
  <!-- æ¬¢è¿åŒºåŸŸ -->
  <view class="welcome-section">
    <view class="welcome-text" bindtap="onWelcomeTextTap">{{welcomeText}}</view>
    <view class="welcome-subtitle">{{subtitle}}</view>
    
    <!-- ç”¨æˆ·ä¿¡æ¯ -->
    <view class="user-info" wx:if="{{userInfo && userInfo.nickName}}">
      <image class="user-avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.svg'}}" mode="aspectFill"></image>
      <view class="user-name">{{userInfo.nickName}}</view>
    </view>
  </view>

  <!-- æµ‹è¯•ç±»å‹é€‰æ‹© -->
  <view class="test-types-section">
    <view class="section-title">é€‰æ‹©æµ‹è¯•æ–¹å¼</view>
    
    <view class="test-type-grid">
      <view 
        class="test-type-card" 
        wx:for="{{testTypes}}" 
        wx:key="id"
        data-type="{{item.id}}"
        bindtap="selectTestType"
        style="border-color: {{item.color}}"
      >
        <view class="card-icon" style="color: {{item.color}}">{{item.icon}}</view>
        <view class="card-content">
          <view class="card-title" style="color: {{item.color}}">{{item.title}}</view>
          <view class="card-subtitle">{{item.subtitle}}</view>
          <view class="card-description">{{item.description}}</view>
        </view>
        <view class="card-arrow">â†’</view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘æµ‹è¯•è®°å½• -->
  <view class="recent-tests-section" wx:if="{{recentTests.length > 0}}">
    <view class="section-header">
      <view class="section-title">æœ€è¿‘æµ‹è¯•</view>
    </view>
    
    <view class="recent-tests-list">
      <view 
        class="recent-test-item"
        wx:for="{{recentTests}}"
        wx:key="_id"
        data-id="{{item._id}}"
        bindtap="viewResult"
      >
        <view class="test-result-type">{{item.mbti_type}}</view>
        <view class="test-result-info">
          <view class="test-result-title">{{item.metadata.nickname}}</view>
          <view class="test-result-time">{{item.created_at}}</view>
        </view>
        <view class="test-result-arrow">></view>
      </view>
    </view>
  </view>

  <!-- æ•°æ®åˆå§‹åŒ–æŒ‰é’®ï¼ˆä¸´æ—¶ï¼‰ -->
  <view class="admin-section" wx:if="{{isAdminMode}}">
    <view class="admin-title">ç®¡ç†å‘˜åŠŸèƒ½</view>
    <button class="btn-admin" bindtap="initDatabase">åˆå§‹åŒ–æ•°æ®åº“</button>
    <button class="btn-admin" bindtap="importData">å¯¼å…¥æ•°æ®</button>
    <button class="btn-admin btn-quick" bindtap="quickImport">å¿«é€Ÿå¯¼å…¥ï¼ˆæµ‹è¯•ï¼‰</button>
  </view>

  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <view class="footer-section">
    <view class="footer-text">
      <text>MBTIæµ‹è¯•ä»…ä¾›å‚è€ƒï¼Œ</text>
      <text>æ€§æ ¼ä¼šéšç€ç»å†å’Œæˆé•¿è€Œå‘å±•å˜åŒ–</text>
    </view>
    <view class="footer-tips">
      <text>ğŸ’¡ å»ºè®®ï¼šå®šæœŸæµ‹è¯•ï¼Œè§‚å¯Ÿè‡ªå·±çš„æˆé•¿å˜åŒ–</text>
    </view>
    
    <!-- åˆ†äº«æŒ‰é’® -->
    <view class="share-section">
      <button class="share-btn" open-type="share">
        <view class="share-icon">ğŸ“¤</view>
        <view class="share-text">åˆ†äº«ç»™æœ‹å‹</view>
      </button>
    </view>
    
    <!-- æ¿€æ´»ç®¡ç†å‘˜æ¨¡å¼ï¼ˆä¸´æ—¶ï¼‰ -->
    <view class="admin-activate" bindtap="toggleAdminMode">
      <!-- <text class="admin-hint">é•¿æŒ‰æ­¤å¤„5æ¬¡æ¿€æ´»ç®¡ç†å‘˜æ¨¡å¼</text> -->
    </view>
  </view>
</view>